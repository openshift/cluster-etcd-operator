apiVersion: apiextensions.k8s.io/v1 # Hack because controller-gen complains if we don't have this
name: "[TechPreview] Backup"
crd: 0000_10_config-operator_01_backup-TechPreviewNoUpgrade.crd.yaml
tests:
  onCreate:
  - name: Should be able to create a Backup with a valid spec
    initial: |
      apiVersion: config.openshift.io/v1alpha1
      kind: Backup
      spec:
        etcdBackupSpec:
          schedule: * 2 * * *
          pvcName: etcdbackup-pvc
    expected: |
      apiVersion: config.openshift.io/v1alpha1
      kind: Backup
      spec:
        etcdBackupSpec:
          schedule: * 2 * * *
          pvcName: etcdbackup-pvc
  - name: Should fail to create an EtcdBackup without the required pvcName
    initial: |
      apiVersion: config.openshift.io/v1alpha1
      kind: Backup
      spec:
        etcdBackupSpec:
          schedule: * 2 * * *
    expectedError: "spec.etcdBackupSpec.pvcName: Required value"
